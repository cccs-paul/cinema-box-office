<!--
  myRC - Login Component Template
  Copyright (c) 2026 myRC Team
  Licensed under MIT License
-->
<div class="login-container">
  <!-- Language Switcher - Top Right -->
  <button class="btn-language-login" (click)="toggleLanguage()">
    {{ getOtherLanguageLabel() }}
  </button>

  <!-- Header Section -->
  <header class="login-header">
    <div class="login-brand">
      <img src="assets/logo.svg" alt="myRC Logo" class="login-logo" width="48" height="48">
      <h1>{{ title }}</h1>
    </div>
    <p>{{ 'login.subtitle' | translate }}</p>
  </header>

  <!-- Main Login Section -->
  <main class="login-main">
    <div class="login-card">
      <!-- Loading state for login methods -->
      <div *ngIf="isLoadingLoginMethods" class="loading-methods">
        <span class="spinner"></span>
        <span>{{ 'login.loadingAuthOptions' | translate }}</span>
      </div>

      <!-- No login methods available -->
      <div *ngIf="!isLoadingLoginMethods && !hasAnyLoginMethod" class="no-methods-message">
        <span class="message-icon">âš ï¸</span>
        <p>{{ 'login.noAuthMethods' | translate }}</p>
        <p>{{ 'login.contactAdmin' | translate }}</p>
      </div>

      <!-- Tab Navigation (only show if login methods are loaded and at least one is enabled) -->
      <nav *ngIf="!isLoadingLoginMethods && hasAnyLoginMethod" class="auth-tabs">
        <button
          *ngIf="loginMethods.appAccount.enabled"
          [class.active]="activeTab === 'local'"
          (click)="switchTab('local')"
          class="tab-button"
        >
          <span class="tab-icon">ğŸ‘¤</span>
          <span class="tab-text">{{ 'login.tabs.appAccount' | translate }}</span>
        </button>
        <button
          *ngIf="loginMethods.ldapEnabled"
          [class.active]="activeTab === 'ldap'"
          (click)="switchTab('ldap')"
          class="tab-button"
        >
          <span class="tab-icon">ğŸ”</span>
          <span class="tab-text">{{ 'login.tabs.ldap' | translate }}</span>
        </button>
        <button
          *ngIf="loginMethods.oauth2Enabled"
          [class.active]="activeTab === 'oauth2'"
          (click)="switchTab('oauth2')"
          class="tab-button"
        >
          <span class="tab-icon">ğŸŒ</span>
          <span class="tab-text">{{ 'login.tabs.oauth2' | translate }}</span>
        </button>
      </nav>

      <!-- Messages -->
      <div *ngIf="errorMessage" class="alert alert-error">
        <span class="alert-icon">âŒ</span>
        <span class="alert-text">{{ errorMessage }}</span>
      </div>
      <div *ngIf="successMessage" class="alert alert-success">
        <span class="alert-icon">âœ…</span>
        <span class="alert-text">{{ successMessage }}</span>
      </div>

      <!-- LOCAL Authentication Tab -->
      <div *ngIf="!isLoadingLoginMethods && loginMethods.appAccount.enabled && activeTab === 'local'" class="tab-content active">
        <form [formGroup]="localForm" (ngSubmit)="loginLocal()" class="login-form">
          <div class="form-group">
            <label for="username" class="form-label">{{ 'login.username' | translate }}</label>
            <input
              id="username"
              type="text"
              formControlName="username"
              class="form-input"
              [placeholder]="'login.usernamePlaceholder' | translate"
            />
            <small class="form-hint">{{ 'login.demoUsername' | translate }}</small>
          </div>

          <div class="form-group">
            <label for="password" class="form-label">{{ 'login.password' | translate }}</label>
            <input
              id="password"
              type="password"
              formControlName="password"
              class="form-input"
              [placeholder]="'login.passwordPlaceholder' | translate"
            />
            <small class="form-hint">{{ 'login.demoPassword' | translate }}</small>
          </div>

          <div class="form-group checkbox">
            <input
              id="rememberMe"
              type="checkbox"
              formControlName="rememberMe"
              class="form-checkbox"
            />
            <label for="rememberMe" class="form-label checkbox-label">{{ 'login.rememberMe' | translate }}</label>
          </div>

          <button
            type="submit"
            [disabled]="isLoading || localForm.invalid"
            class="btn btn-primary btn-block"
          >
            <span *ngIf="!isLoading">{{ 'login.signIn' | translate }}</span>
            <span *ngIf="isLoading">{{ 'login.signingIn' | translate }}</span>
          </button>
        </form>

        <!-- Registration Link -->
        <div *ngIf="allowRegistration" class="register-link-section">
          <p>{{ 'login.noAccount' | translate }}</p>
          <a routerLink="/register" class="register-link">{{ 'login.createAccount' | translate }}</a>
        </div>
      </div>

      <!-- LDAP Authentication Tab -->
      <div *ngIf="!isLoadingLoginMethods && loginMethods.ldapEnabled && activeTab === 'ldap'" class="tab-content active">
        <form [formGroup]="ldapForm" (ngSubmit)="loginLdap()" class="login-form">
          <div class="form-group">
            <label for="ldapUsername" class="form-label">{{ 'login.ldapUsername' | translate }}</label>
            <input
              id="ldapUsername"
              type="text"
              formControlName="ldapUsername"
              class="form-input"
              [placeholder]="'login.ldapUsernamePlaceholder' | translate"
              [disabled]="isLoading"
            />
          </div>

          <div class="form-group">
            <label for="ldapPassword" class="form-label">{{ 'login.ldapPassword' | translate }}</label>
            <input
              id="ldapPassword"
              type="password"
              formControlName="ldapPassword"
              class="form-input"
              [placeholder]="'login.ldapPasswordPlaceholder' | translate"
              [disabled]="isLoading"
            />
          </div>

          <button
            type="submit"
            [disabled]="isLoading || ldapForm.invalid"
            class="btn btn-primary btn-block"
          >
            <span *ngIf="!isLoading">{{ 'login.signInLdap' | translate }}</span>
            <span *ngIf="isLoading">{{ 'login.authenticating' | translate }}</span>
          </button>
        </form>
      </div>

      <!-- OAuth2 Authentication Tab -->
      <div *ngIf="!isLoadingLoginMethods && loginMethods.oauth2Enabled && activeTab === 'oauth2'" class="tab-content active">
        <div class="oauth-buttons">
          <button
            type="button"
            (click)="loginOAuth2('google')"
            [disabled]="isLoading"
            class="btn btn-oauth btn-google"
          >
            <span class="oauth-icon">ğŸ”µ</span>
            <span *ngIf="!isLoading">{{ 'login.signInGoogle' | translate }}</span>
            <span *ngIf="isLoading">{{ 'login.redirecting' | translate }}</span>
          </button>

          <button
            type="button"
            (click)="loginOAuth2('github')"
            [disabled]="isLoading"
            class="btn btn-oauth btn-github"
          >
            <span class="oauth-icon">âš«</span>
            <span *ngIf="!isLoading">{{ 'login.signInGithub' | translate }}</span>
            <span *ngIf="isLoading">{{ 'login.redirecting' | translate }}</span>
          </button>

          <button
            type="button"
            (click)="loginOAuth2('microsoft')"
            [disabled]="isLoading"
            class="btn btn-oauth btn-microsoft"
          >
            <span class="oauth-icon">â—¼ï¸</span>
            <span *ngIf="!isLoading">{{ 'login.signInMicrosoft' | translate }}</span>
            <span *ngIf="isLoading">{{ 'login.redirecting' | translate }}</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Footer Info -->
    <footer class="login-footer">
      <div class="footer-content">
        <div class="footer-section">
          <p>{{ 'login.copyright' | translate }}</p>
        </div>
        
        <div class="footer-divider"></div>
        
        <div class="footer-status">
          <div class="status-compact">
            <div class="status-item-compact">
              <span class="status-label">{{ 'login.api' | translate }}:</span>
              <div [class.healthy]="isApiHealthy" [class.unhealthy]="!isApiHealthy" class="status-indicator-compact">
                <span class="status-dot"></span>
                <span class="status-text">{{ apiStatus }}</span>
              </div>
            </div>
            <div class="status-item-compact">
              <span class="status-label">{{ 'login.database' | translate }}:</span>
              <div [class.healthy]="isDatabaseHealthy" [class.unhealthy]="!isDatabaseHealthy" class="status-indicator-compact">
                <span class="status-dot"></span>
                <span class="status-text">{{ databaseStatus }}</span>
              </div>
            </div>
          </div>
          
          <div class="tools-links">
            <a href="http://localhost:8080/api/swagger-ui.html" target="_blank" class="tool-link" [title]="'login.apiDocs' | translate">
              <span>ğŸ“š</span>
            </a>
            <a href="http://localhost:5050" target="_blank" class="tool-link" [title]="'login.dbConsole' | translate">
              <span>ğŸ—„ï¸</span>
            </a>
          </div>
        </div>
      </div>
    </footer>
  </main>
</div>